<!DOCTYPE html>
<html>
<head>
<title>QUBeditotron3000</title>

<script type="text/javascript">


const apiBaseUrl = "http://127.0.0.1:9000"; 

let currentRequest = null;

function makeRequest(endpoint, callback) {
    if (currentRequest) currentRequest.abort();

    let xhttp = new XMLHttpRequest();
    currentRequest = xhttp;

    let url = apiBaseUrl + endpoint + "?text=" + encodeURI(content.value);

    // Append the current query string if it already exists
    let currentUrl = window.location.href;
    let queryString = currentUrl.split('?')[1];
    if (queryString) {
        url += '&' + queryString;  // Keep existing query parameters
    }

    xhttp.onreadystatechange = () => {
        if (xhttp.readyState == 4) {
            currentRequest = null;
            if (xhttp.status == 200) {
                try { callback(JSON.parse(xhttp.response).answer); } 
                catch (e) { output.value = `Error parsing: ${e}`; }
            } else {
                output.value = `Error: ${xhttp.status} - ${xhttp.statusText}`;
            }
        }
    };
    xhttp.open("GET", url);
    xhttp.send();
}



const fullStopCounter = () => makeRequest("/api/full-stop-count", result => output.value = result);


</script>

<style type="text/css">
body  {
    font-size: 150%;
    background-color: #7FBEAB;
    font-family: monospace;
}

#logo
{
    font-family: Calibri, sans-serif;
    font-weight: lighter;
    color: #85877C;
    margin: 0.5em;
}

#editor
{
    text-align: center;
    margin-top: 1em;
}

#output {
    font-size: 100%;
    padding: 0.2em;
    margin: 0.2em;
    font-family: monospace;
    letter-spacing: 0.1em;
}

#content {
    font-size: 100%;
    padding: 0.2em;
    margin: 0.2em;
    font-family: monospace;
    letter-spacing: 0.1em;
}

.operation {
    border: solid rgb(0, 0, 0) 1px;
    background-color: #85877C;
    padding: 1.5em;
    margin: 1em;
    width: 14em;
}
</style>

</head>
<body>
<div id="editor">
    <div id="logo">
        QUBeditotron3000
    </div>
    <div>
        <textarea rows="5" cols="40" id="content">It was the best of cloud, it was the worst of cloud...</textarea>
    </div>
    <div>
        <input type="text" id="output" readonly="1" value="" />
    </div>
    <div>
        <button class="operation" onclick="Wordcount();">Word Count</button>
        <button class="operation" onclick="Charcount();">Character Count</button>
    </div>
    <div>
        <button class="operation" onclick="spellCheck();">Spell Check</button>
        <button class="operation" onclick="fullStopCounter();">"FullStops Count"</button>
    </div>
    <div>
        <button class="operation" onclick="">??</button>
        <button class="operation" onclick="">??</button>
    </div>
    <div>
        <button class="operation" onclick="">??</button>
        <button class="operation" onclick="">??</button>
    </div>
    <div>
        <button class="operation" onclick="">??</button>
        <button class="operation" onclick="">??</button>
    </div>
    
</div>
</body>


</html>
